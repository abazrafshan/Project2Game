$(function(){function a(){$.ajax("/api/property",{type:"GET"}).then(function(a){let b=0,c=0;for(let d=0;d<a.length;d++)1==a[d].PlayerId?b+=parseInt(a[d].price):2==a[d].PlayerId&&(c+=parseInt(a[d].price));$.ajax("/api/players",{type:"GET"}).then(function(a){b+=parseInt(a[0].money),c+=parseInt(a[1].money),b>c?(status1="WIN",status2="LOSS"):b==c?(status1="TIE",status2="TIE"):(status1="LOSS",status2="WIN"),$(`#money1`).text(`Net Worth: $${b}`),$(`#money2`).text(`Net Worth: $${c}`),$(`#prop1`).text(`Result: ${status1}`),$(`#prop2`).text(`Result: ${status2}`),"WIN"==status1?$("#p1").attr("style","border: 2px solid yellow;"):"WIN"==status2&&$("#p2").attr("style","border 2px solid yellow;"),$("#turn").html(`<h4>${"WIN"==status1?"Player 1 Wins!":"WIN"==status2?"Player 2 Wins!":"TIE"}</h4>`),$(".endTurn").text("Play Again"),$(".endTurn").addClass("endBtn"),$(".endBtn").removeClass("endTurn"),$(".endBtn").on("click",function(){location.reload()})})})}var b=1;$("#turn").html(`<h4>Ready Player ${b}<h4>`),$(".diceBtn").off().on("click",function(){function c(){b=1===b?2:1,$.ajax("/api/players/"+b,{type:"GET"}).then(function(a){let c=parseInt(a.money),d=1===b?2:1;$.ajax("/api/players/"+d,{type:"GET"}).then(function(a){let e=parseInt(a.money),f=Math.floor(e/10);e-=parseInt(f),c+=parseInt(f),console.log(`Player ${b} pickpocketed $${f} from Player ${d}!`),$.ajax({type:"PUT",data:{money:e},url:"/api/players/"+d}),$.ajax({type:"PUT",data:{money:c},url:"/api/players/"+b}),$(`#money${d}`).text(`Money: $${e}`),$(`#money${b}`).text(`Money: $${c}`)})})}let d=document.getElementById("die1"),e=document.getElementById("die2"),f=document.getElementById("status"),g=Math.floor(6*Math.random())+1,h=Math.floor(6*Math.random())+1,i=g+h;d.innerHTML=g,e.innerHTML=h,f.innerHTML="You rolled "+i+".",g===h&&(f.innerHTML+=" Doubles!"),$.ajax("/api/players/"+b,{type:"GET"}).then(function(d){let e=d.currentSpace,f=d.money,g=document.getElementsByClassName(`p`+b);for(let a=0;a<g.length;a++)g[a].dataset.id==e&&(g[a].style.display="none");let h=e+i;h=16<h?h-16:h;for(let a=0;a<g.length;a++)g[a].dataset.id==h&&(g[a].style.display="block");$.ajax({type:"PUT",data:{currentSpace:h},url:"/api/players/"+b}).then(function(){if(16===h)console.log(`Player ${b} landed on Go!`),$.ajax("/api/property",{type:"GET"}).then(function(a){for(let c=0;c<a.length;c++)a[c].PlayerId===b&&(f=parseInt(f),f+=parseInt(a[c].payout));$.ajax({type:"PUT",data:{money:f},url:"/api/players/"+b}).then(function(){$(`#money${b}`).text(`Money: $${f}`),$(".endTurn").click()})});else if(16>e&&h<e)console.log(`Player ${b} passed Go!`),$.ajax("/api/property",{type:"GET"}).then(function(a){for(let c=0;c<a.length;c++)a[c].PlayerId===b&&(f=parseInt(f),f+=parseInt(a[c].payout));$.ajax({type:"PUT",data:{money:f},url:"/api/players/"+b}).then(function(){$(`#money${b}`).text(`Money: $${f}`);let a=document.getElementsByClassName("buyBtn"),d=1===b?2:1,e=document.getElementsByClassName(`p${d}`);for(let b=0;b<e.length-1;b++)a[b].dataset.id==h&&"none"==a[b].style.display&&"none"==e[b].style.display?$(".endTurn").click():e[b].dataset.id==h&&"block"==e[b].style.display&&c()})});else{console.log(`Player ${b} moved!`);let a=document.getElementsByClassName("buyBtn"),d=1===b?2:1,e=document.getElementsByClassName(`p${d}`);for(let b=0;b<e.length-1;b++)a[b].dataset.id==h&&"none"==a[b].style.display&&"none"==e[b].style.display?$(".endTurn").click():e[b].dataset.id==h&&"block"==e[b].style.display&&c()}$(".endTurn").off().on("click",function(){b=1===b?2:1,$("#turn").html(`<h4>Ready Player ${b}<h4>`),console.log("Ended turn")}),$(".buyBtn").off().on("click",function(){let c=$(this).data("id");$.ajax("/api/property/"+c,{type:"GET"}).then(function(d){let e=d.price,g=f-e;$.ajax({type:"PUT",data:{money:g},url:"/api/players/"+b}).then(function(){$.ajax({type:"PUT",data:{owned:!0,PlayerId:b},url:"/api/property/"+c}).then(function(){let d=document.getElementsByClassName("buyBtn");for(let a=0;a<d.length;a++)d[a].dataset.id==h&&(d[a].style.display="none");$.ajax("/api/property",{type:"GET"}).then(function(e){let f=0;for(let a=0;a<e.length;a++)e[a].PlayerId==b&&(f+=1);let h=document.getElementsByClassName("card");for(let a=0;a<h.length;a++)h[a].getAttribute("data-id")==c&&(h[a].style.border=`2px solid ${1==b?"red":"blue"}`);console.log(`Player ${b} purchased a property!`),$(`#money${b}`).text(`Money: $${g}`),$(`#prop${b}`).text(`Number of Properties: ${f}`),$(".endTurn").click();let j=0;for(let a=0;a<d.length;a++)"none"==d[a].style.display&&(j+=1);15==j&&a()})})})})})})})})});